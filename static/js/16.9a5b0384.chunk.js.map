{"version":3,"sources":["components/PersonalChatsList/PersonalChatsListItem/PersonalChatsListItem.module.css","components/PersonalChatsList/PersonalChatsListItem/PersonalChatsListItem.js","components/PersonalChatsList/PersonalChatsList.js","lib/chats/personal-chat-list-item.js","components/PersonalChatsOverview/PersonalChatsOverview.js","stores/PersonalChatStore.js"],"names":["module","exports","PersonalChatsListItem","greyDisplayName","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","componentDidMount","asyncToGenerator","regenerator_default","a","mark","_callee","chatItem","profileImage","wrap","_context","prev","next","personalChatPromise","sent","setState","chatItemLoaded","getProfileImage","uid","profileImageLoaded","stop","onClick","_callee2","_context2","history","push","concat","state","userPublicData","src","alt","displayName","react_default","createElement","react_onsenui","tappable","modifier","className","width","height","styles","Component","withRouter","PersonalChatsList","renderListItem","item","key","PersonalChatsList_PersonalChatsListItem_PersonalChatsListItem","personalChatPromises","map","PersonalChatListItem","blocked","create","personalChatInfo","firebase","database","ref","once","abrupt","val","PersonalChatsOverview","personalChats","ready","AuthStore","readyPromise","PersonalChatStore","getAllPersonalChats","chatInfo","renderToolbar","ToolbarNormal","name","style","padding","marginLeft","components_PersonalChatsList_PersonalChatsList","D_Apps_projectmegaindia_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__","D_Apps_projectmegaindia_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_4__","D_Apps_projectmegaindia_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_5__","init","D_Apps_projectmegaindia_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_2__","D_Apps_projectmegaindia_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_1___default","getChatsMetas","chatMeta","isReady","emit","getChatMetaIds","getField","_ref3","_callee3","objectID","snapshot","_context3","_x","_x2","apply","arguments","getSingleChatMeta","_ref4","_callee4","_ref5","_ref6","title","slug","isLeaf","_context4","Promise","all","D_Apps_projectmegaindia_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","ChatMeta","_x3","getChatMetaItem","otherUidSlug","myUid","user","uid1","uid2","trySetChatToUserData","_callee5","objectIDs","_context5","getChatSubjectsFlat","_callee6","_context6","slice","sort","amountOfSlashesSort","getChatSubjects","_callee7","subjectsArray","subjects","_context7","forEach","subject","nestChatSubject","getChatThread","_ref10","_callee8","chatThread","_context8","Error","threads","ChatThread","fromChatMeta","_x4","_callee9","chats","_context9","isAuthenticated","keys","chat","filter","_ref12","_callee10","otherUserUid","_context10","set","_x5","AbstractChatStore","__webpack_exports__"],"mappings":"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","file":"static/js/16.9a5b0384.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"PersonalChatsListItem\":\"PersonalChatsListItem_PersonalChatsListItem__1gmLP\",\"greyDisplayName\":\"PersonalChatsListItem_greyDisplayName__3Reh7\"};","import React, { Component } from 'react';\nimport styles from './PersonalChatsListItem.module.css';\nimport { getProfileImage } from '../../../lib/user';\nimport { List, ListItem } from 'react-onsenui';\nimport { withRouter } from 'react-router-dom';\n\nconst greyImgURI = 'data:image/png;base64,iVBORw0KGgoAAAAN'\n    + 'SUhEUgAAADIAAAAyAQMAAAAk8RryAAAAA1BMVEWZmZl86KQWAAA'\n    + 'ADklEQVQY02NgGAWDCQAAAZAAAcWb20kAAAAASUVORK5CYII=';\n\nclass PersonalChatsListItem extends Component {\n    constructor(props) {\n        super();\n        this.state = {\n        };\n\n    }\n\n    componentDidMount = async () => {\n        const chatItem = await this.props.personalChatPromise;\n        this.setState({\n            chatItem: chatItem,\n            chatItemLoaded: true\n        });\n        const profileImage = await getProfileImage(chatItem.uid);\n        this.setState({\n            profileImage: profileImage,\n            profileImageLoaded: true\n        });\n    }\n\n    componentWillUnmount() {\n    }\n\n    onClick = async () => {\n        await this.props.personalChatPromise;\n        this.props.history.push(`/chats/personal/${this.state.chatItem.uid}`);\n    }\n\n    render() {\n        const chatItemLoaded = this.state.chatItemLoaded;\n        const chatItem = this.state.chatItem || {};\n        const userPublicData = chatItem.userPublicData || {};\n        const src = this.state.profileImage || greyImgURI;\n        const alt = (userPublicData.displayName || 'User') + ' avatar';\n\n        return (\n            <ListItem tappable\n                modifier=\"chevron\"\n                className=\"PersonalChatsListItem\"\n                onClick={this.onClick}>\n                <div className=\"left\">\n                    <img width=\"50\" height=\"50\"\n                        className=\"list-item__thumbnail\"\n                        alt={alt}\n                        src={src} />\n                </div>\n                <div className=\"center\">\n                    <div className={chatItemLoaded ? null : styles.greyDisplayName}>\n                        {userPublicData.displayName || 'Anonymous'}\n                    </div>\n                </div>\n                <div className=\"right\">\n\n                </div>\n            </ListItem>\n        );\n    }\n}\n\nexport default withRouter(PersonalChatsListItem);\n","import React, { Component } from 'react';\nimport './PersonalChatsList.css';\nimport { List, ListItem } from 'react-onsenui';\nimport PersonalChatsListItem from './PersonalChatsListItem/PersonalChatsListItem';\n\nclass PersonalChatsList extends Component {\n    constructor(props) {\n        super();\n        this.state = {\n\n        };\n\n    }\n\n    componentWillMount() {\n    }\n\n    componentWillUnmount() {\n    }\n\n    renderListItem = (item, key) => {\n        return (\n            <PersonalChatsListItem personalChatPromise={item} key={key} />\n        );\n    }\n\n    render() {\n        if (!this.props.personalChatPromises) return null;\n        return (\n            <div className=\"PersonalChatsList\">\n                <List>\n                    {this.props.personalChatPromises.map(this.renderListItem)}\n                </List>\n            </div>\n        );\n    }\n}\n\nexport default PersonalChatsList;\n","import firebase from '../../lib/firebase';\r\n\r\nexport default class PersonalChatListItem {\r\n    constructor(uid, blocked, userPublicData) {\r\n        this.uid = uid;\r\n        this.blocked = blocked;\r\n        this.userPublicData = userPublicData;\r\n    }\r\n\r\n    static create = async (personalChatInfo) => {\r\n        const uid = personalChatInfo.uid;\r\n        const blocked = personalChatInfo.blocked;\r\n        const userPublicData = await firebase.database().ref(`/users/${uid}/public`)\r\n            .once('value');\r\n        return new PersonalChatListItem(uid, blocked, userPublicData.val());\r\n    }\r\n}\r\n","import React, { Component } from 'react';\nimport { Card, Page } from 'react-onsenui';\nimport './PersonalChatsOverview.css';\nimport PersonalChatsList from '../PersonalChatsList/PersonalChatsList';\nimport PersonalChatStore from '../../stores/PersonalChatStore';\nimport firebase from '../../lib/firebase';\nimport PersonalChatListItem from '../../lib/chats/personal-chat-list-item';\nimport ToolbarNormal from '../ToolbarNormal/ToolbarNormal';\nimport AuthStore from '../../stores/AuthStore';\n\nclass PersonalChatsOverview extends Component {\n    constructor(props) {\n        super();\n        this.state = {\n        };\n\n    }\n\n    componentDidMount = async () => {\n        await firebase.ready;\n        await AuthStore.readyPromise;\n        const personalChats = await PersonalChatStore.getAllPersonalChats();\n        this.setState({\n            personalChatPromises: personalChats.map(chatInfo => PersonalChatListItem.create(chatInfo))\n        });\n    }\n\n    componentWillUnmount() {\n    }\n\n    render() {\n        return (\n            <Page className=\"PersonalChatsOverview\" renderToolbar={() => <ToolbarNormal name=\"Chats overzicht\" />}>\n                <Card style={{ padding: 0 }}>\n                    <h5 style={{ marginLeft: 10 }}>Chats overzicht</h5>\n                    <PersonalChatsList personalChatPromises={this.state.personalChatPromises} />\n                </Card>\n            </Page>\n        );\n    }\n}\n\nexport default PersonalChatsOverview;\n","import { EventEmitter } from \"events\";\r\nimport { ChatMeta } from \"../lib/chats/chat-meta\";\r\nimport { ChatThread } from \"../lib/chats/chat-thread\";\r\nimport AbstractChatStore from \"./AbstractChatStore\";\r\nimport AuthStore from \"./AuthStore\";\r\nimport firebase from '../lib/firebase';\r\n\r\nclass PersonalChatStore extends AbstractChatStore {\r\n    constructor() {\r\n        super();\r\n\r\n        this.threads = {};\r\n        this.init();\r\n    }\r\n\r\n    init = async () => {\r\n        this.chatMeta = await this.getChatsMetas();\r\n        this.isReady = true;\r\n        this.emit('change');\r\n    }\r\n\r\n    getChatMetaIds = async () => {\r\n        return [];\r\n    }\r\n\r\n    getField = async (objectID, key) => {\r\n        await firebase.ready;\r\n        const snapshot = await firebase.database().ref(`/chats/personal/${objectID}/${key}`).once('value');\r\n        return snapshot.val();\r\n    }\r\n\r\n    getSingleChatMeta = async (objectID) => {\r\n        await firebase.ready;\r\n        const [title, slug, isLeaf] = await Promise.all(\r\n            ['title', 'slug', 'isLeaf'].map(key => this.getField(objectID, key))\r\n        );\r\n        return new ChatMeta(title, isLeaf, slug, objectID);\r\n    }\r\n\r\n    getChatMetaItem = otherUidSlug => {\r\n        const myUid = AuthStore.user.uid;\r\n        const uid1 = myUid > otherUidSlug ? otherUidSlug : myUid;\r\n        const uid2 = myUid > otherUidSlug ? myUid : otherUidSlug;\r\n        this.trySetChatToUserData(otherUidSlug);\r\n        return {\r\n            title: \"\",\r\n            isLeaf: false,\r\n            slug: otherUidSlug,\r\n            objectID: `${uid1}/${uid2}`\r\n        };\r\n    }\r\n\r\n    getChatsMetas = async () => {\r\n        await firebase.ready;\r\n        const objectIDs = await this.getChatMetaIds();\r\n        return await Promise.all(objectIDs.map(this.getSingleChatMeta));\r\n    };\r\n\r\n    getChatSubjectsFlat = async () => {\r\n        const chatMeta = await this.getChatsMetas();\r\n        return chatMeta.slice().sort(this.amountOfSlashesSort);\r\n    };\r\n\r\n    getChatSubjects = async () => {\r\n        const subjectsArray = await this.getChatSubjectsFlat();\r\n        const subjects = [];\r\n        subjectsArray.forEach(subject => this.nestChatSubject(subject, subjects));\r\n        return subjects;\r\n    };\r\n\r\n    getChatThread = async chatMeta => {\r\n        if (chatMeta === null) throw new Error('Invalid chat meta');\r\n        if (this.threads[chatMeta.objectID]) return this.threads[chatMeta.objectID];\r\n        await firebase.ready;\r\n        const chatThread = ChatThread.fromChatMeta(chatMeta, firebase.database().ref(`/chats/personal/${chatMeta.objectID}/thread`));\r\n        this.threads[chatMeta.objectID] = chatThread;\r\n        return chatThread;\r\n    };\r\n\r\n    getAllPersonalChats = async () => {\r\n        await firebase.ready;\r\n        await AuthStore.readyPromise;\r\n        const loggedIn = AuthStore.isAuthenticated;\r\n        if (!loggedIn) return null;\r\n        const snapshot = await firebase.database()\r\n            .ref(`/users/${AuthStore.user.uid}/personalchatswithusers`)\r\n            .once('value');\r\n        const chats = snapshot.val() || {};\r\n        return Object.keys(chats).map(key => {\r\n            const chat = chats[key];\r\n            chat.uid = key;\r\n            return chat;\r\n        }).filter(chat => chat.blocked !== true);\r\n    }\r\n\r\n    trySetChatToUserData = async (otherUserUid) => {\r\n        await firebase.ready;\r\n        await AuthStore.readyPromise;\r\n        const loggedIn = AuthStore.isAuthenticated;\r\n        if (!loggedIn) return false;\r\n        const snapshot = await firebase.database()\r\n            .ref(`/users/${AuthStore.user.uid}/personalchatswithusers/${otherUserUid}`)\r\n            .once('value');\r\n        if (snapshot.val() === null) {\r\n            await await firebase.database()\r\n                .ref(`/users/${AuthStore.user.uid}/personalchatswithusers/${otherUserUid}`)\r\n                .set({\r\n                    blocked: false\r\n                });\r\n            const snapshot2 = await firebase.database()\r\n                .ref(`/users/${otherUserUid}/personalchatswithusers/${AuthStore.user.uid}`)\r\n                .once('value');\r\n            if (snapshot2.val() === null) {\r\n                await await firebase.database()\r\n                    .ref(`/users/${otherUserUid}/personalchatswithusers/${AuthStore.user.uid}`)\r\n                    .set({\r\n                        blocked: false\r\n                    });\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default new PersonalChatStore();\r\n"],"sourceRoot":""}